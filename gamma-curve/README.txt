This is Scilab code (similar to MATLAB)

Linear scaling of pulse-width results in uneven brightness change to the human eye. This code generates a nice conversion function, to allow for even brightness change. It is precalculated because the Arduino UNO is too busy for intense math. The resulting values go into:

sunrise_functions.cpp